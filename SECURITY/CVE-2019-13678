CVE-2019-16378 - OpenDMARC through 1.3.2 and 1.4.x through 1.4.0-Beta1 is 
prone to a signature-bypass vulnerability with multiple From: addresses, 
which might affect applications that consider a domain name to be relevant 
to the origin of an e-mail message.

Link: https://nvd.nist.gov/vuln/detail/CVE-2019-16378

Background Details: 

When implemented, the DMARC RFC (RFC7489) assumed that emails with multiple 
From: fields would be rejected by the receiving MTA (Section RFC7489 section 
6.6.1), and that emails containing such a header would be rare in practice.  

In the case where such a message is received, the RFC recommends (in the 
same section) that both domains be tested, and the strictest policy be 
applied.

However, having two distinct administrative domains in the same From: 
header (for example, a@gmail.com, b@hotmail.com) leads to an issue: 

For SPF, mail can only be delivered to a receiving system from one IP.  
Unless that IP address is (coicidentally or intentionally) in both 
domains' spf records (or the domains include: each other), then the SPF 
check will fail (forged HELO's notwithstanding).

For DKIM, there can only be one selector/domain in a given DKIM-Signature, 
referencing a single "From:" header.  So in the case where either domain 
specifies a dmarc policy of either p=reject or p=quarantine, the result 
will be a failure.

In practice, citing the example above, a message cannot have been signed 
as being delivered to a receiving system immediately after originating from 
both gmail.com and hotmail.com.  While it's possible to have a message
relayed *through* one system via another, this is not what DMARC attempts
to solve, and is what ARC is for.

RFC7489 Also states (section 3.1.1):    Note that a single email can contain 
multiple DKIM signatures, and it is considered to be a DMARC "pass" if any 
DKIM signature is aligned and verifies.

The behavior of a case of there being multiple distinct domains does not 
appear to have been considered by this section, as it seems to apply to
multiple signing agents inside a single administrative domain.

Resolution:

Doing all the DMARC checks for every domain in the From: of a message adds 
additional complexity, and opens a vector for abuse.

In the case where a message contains two or more From: addresses from the 
same domain: (For example, "From: professor@science.edu, student@science.edu"), 
both processed and signed by science.edu's mail server, these messages will 
be processed as normal, so long as there is only one unique domain).

For all other cases, OpenDMARC has added an option to outright reject messages 
containing a multi-valued From: field.  If set, messages can be rejected at 
receipt-time.  If unset, messages will be ignored by the filter.  (They will 
not pass, but they will not fail).

The Authentication results field added in this case will have a result of 
dmarc=permerror.